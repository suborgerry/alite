document.addEventListener("DOMContentLoaded",(function(){const t=document.querySelector(".ts-discount-popup-container"),e=(document.querySelector(".ts-discount-popup__text-content"),document.querySelector(".ts-sticky-add"));let n=null,o=0;function c(){window.innerWidth>989||(t.classList.add("show"),n&&clearTimeout(n),n=setTimeout(s,5e3))}function s(){t.classList.remove("show"),n&&clearTimeout(n)}async function i(){try{const t=await fetch("/cart.js");return(await t.json()).items.reduce(((t,e)=>t+e.quantity),0)}catch(t){return 0}}function u(t){const e=document.querySelector(".ts-discount-popup__discount-left"),n=document.querySelector(".ts-discount-popup__highlight"),o=document.querySelector(".ts-discount-popup__text-content");if(!e||!n||!o)return;let c=0,s=0,i=0,u=0;t>=10?(c=30,e.textContent="-30% OFF",n.textContent="30% OFF",o.innerHTML="Max discount reached!"):(t>=6?(c=20,s=30,i=10):t>=4?(c=10,s=20,i=6):(c=0,s=10,i=4),u=i-t,e.textContent=c>0?`-${c}% OFF`:"",n.textContent=`${s}% OFF`,o.innerHTML=`${u} stickers left to get <span class="ts-discount-popup__highlight">${s}% OFF</span>`)}async function r(){u(await i()),c()}!async function(){u(await i())}(),document.addEventListener("submit",(function(t){const e=t.target.closest('form[action^="/cart/add"]');if(e){t.preventDefault();const n=new FormData(e);fetch("/cart/add.js",{method:"POST",body:n}).then((t=>t.json())).then(r).catch(console.error)}}),!0),document.querySelectorAll(".ts-product__button").forEach((t=>{t.addEventListener("click",(()=>{setTimeout(r,700)}))})),e.addEventListener("touchstart",(function(t){o=t.touches[0].clientY})),e.addEventListener("touchend",(function(t){})),e.addEventListener("touchmove",(function(e){const n=e.touches[0].clientY-o;t.classList.contains("show")&&n>50&&s(),-1*n>50&&!t.classList.contains("show")&&c()}))}));